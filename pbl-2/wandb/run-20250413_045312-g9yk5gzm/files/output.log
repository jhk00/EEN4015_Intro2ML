Files already downloaded and verified
Files already downloaded and verified
Train set size: 40000
Validation set size: 5000
Test set size: 5000
Using device: cuda
2개의 GPU를 사용합니다.
  2%|█▊                                                                                           | 2/100 [03:01<2:28:49, 91.12s/it]
Epoch [1], Batch [50/313], Loss: 4.3900
Epoch [1], Batch [100/313], Loss: 4.1090
Epoch [1], Batch [150/313], Loss: 4.1082
Epoch [1], Batch [200/313], Loss: 3.9824
Epoch [1], Batch [250/313], Loss: 3.8416
Epoch [1], Batch [300/313], Loss: 3.5935
Train set: Epoch: 1, Average loss:4.2586, LR: 0.001000 Top-1 Accuracy: 6.2600%, Top-5 Accuracy: 22.0675%, Time consumed:80.07s
Val set: Epoch: 1, Average loss:3.8159, Top-1 Accuracy: 10.3800%, Top-5 Accuracy: 32.7800%, Time consumed:8.96s

New best top-1 accuracy: 10.38%, top-5 accuracy: 32.78%
New best top-5 accuracy: 32.78%
Validation loss decreased (inf --> 3.815898). Saving model ...
Epoch [2], Batch [50/313], Loss: 3.6662
Epoch [2], Batch [100/313], Loss: 4.1941
Epoch [2], Batch [150/313], Loss: 4.2280
Epoch [2], Batch [200/313], Loss: 3.4618
Epoch [2], Batch [250/313], Loss: 3.5255
Epoch [2], Batch [300/313], Loss: 3.8123
Train set: Epoch: 2, Average loss:3.7644, LR: 0.001000 Top-1 Accuracy: 13.6225%, Top-5 Accuracy: 37.7975%, Time consumed:82.50s
Val set: Epoch: 2, Average loss:3.3263, Top-1 Accuracy: 19.4800%, Top-5 Accuracy: 48.9200%, Time consumed:9.19s

New best top-1 accuracy: 19.48%, top-5 accuracy: 48.92%
New best top-5 accuracy: 48.92%
Validation loss decreased (3.815898 --> 3.326332). Saving model ...
Epoch [3], Batch [50/313], Loss: 3.7211
Epoch [3], Batch [100/313], Loss: 2.9829
Epoch [3], Batch [150/313], Loss: 3.7029
Epoch [3], Batch [200/313], Loss: 4.0567
Epoch [3], Batch [250/313], Loss: 3.4003
Epoch [3], Batch [300/313], Loss: 4.0819
Train set: Epoch: 3, Average loss:3.2779, LR: 0.001000 Top-1 Accuracy: 22.0100%, Top-5 Accuracy: 51.7000%, Time consumed:79.49s
Val set: Epoch: 3, Average loss:2.8930, Top-1 Accuracy: 27.5200%, Top-5 Accuracy: 62.8400%, Time consumed:8.89s

New best top-1 accuracy: 27.52%, top-5 accuracy: 62.84%
New best top-5 accuracy: 62.84%
Validation loss decreased (3.326332 --> 2.893042). Saving model ...
Epoch [4], Batch [50/313], Loss: 3.4523
Epoch [4], Batch [100/313], Loss: 2.7672
Epoch [4], Batch [150/313], Loss: 3.9901
Epoch [4], Batch [200/313], Loss: 2.8880
Epoch [4], Batch [250/313], Loss: 2.6688
Epoch [4], Batch [300/313], Loss: 2.3404
Train set: Epoch: 4, Average loss:3.0017, LR: 0.001000 Top-1 Accuracy: 28.6225%, Top-5 Accuracy: 60.3900%, Time consumed:80.86s
Val set: Epoch: 4, Average loss:3.1974, Top-1 Accuracy: 33.9200%, Top-5 Accuracy: 66.0400%, Time consumed:8.60s

New best top-1 accuracy: 33.92%, top-5 accuracy: 66.04%
New best top-5 accuracy: 66.04%
EarlyStopping 카운터: 1 / 10
Epoch [5], Batch [50/313], Loss: 3.0353
Epoch [5], Batch [100/313], Loss: 2.1680
Epoch [5], Batch [150/313], Loss: 2.7582
Epoch [5], Batch [200/313], Loss: 2.0622
Epoch [5], Batch [250/313], Loss: 2.2801
Epoch [5], Batch [300/313], Loss: 2.1226
Train set: Epoch: 5, Average loss:2.7399, LR: 0.001000 Top-1 Accuracy: 35.1175%, Top-5 Accuracy: 66.9100%, Time consumed:81.84s
Val set: Epoch: 5, Average loss:2.6735, Top-1 Accuracy: 39.2800%, Top-5 Accuracy: 72.0000%, Time consumed:8.62s

New best top-1 accuracy: 39.28%, top-5 accuracy: 72.00%
New best top-5 accuracy: 72.00%
Validation loss decreased (2.893042 --> 2.673488). Saving model ...
Epoch [6], Batch [50/313], Loss: 2.0449
Epoch [6], Batch [100/313], Loss: 2.5305
Epoch [6], Batch [150/313], Loss: 2.7565
Epoch [6], Batch [200/313], Loss: 3.5641
Epoch [6], Batch [250/313], Loss: 2.1251
Epoch [6], Batch [300/313], Loss: 1.9355
Train set: Epoch: 6, Average loss:2.6705, LR: 0.001000 Top-1 Accuracy: 38.2400%, Top-5 Accuracy: 69.6375%, Time consumed:79.04s
Val set: Epoch: 6, Average loss:2.7290, Top-1 Accuracy: 42.6600%, Top-5 Accuracy: 74.9000%, Time consumed:8.59s

New best top-1 accuracy: 42.66%, top-5 accuracy: 74.90%
New best top-5 accuracy: 74.90%
EarlyStopping 카운터: 1 / 10
Epoch [7], Batch [50/313], Loss: 3.3097
Epoch [7], Batch [100/313], Loss: 2.2907
Epoch [7], Batch [150/313], Loss: 2.9435
Epoch [7], Batch [200/313], Loss: 1.9167
Epoch [7], Batch [250/313], Loss: 1.7236
Epoch [7], Batch [300/313], Loss: 1.7637
Train set: Epoch: 7, Average loss:2.4306, LR: 0.001000 Top-1 Accuracy: 43.1125%, Top-5 Accuracy: 73.9650%, Time consumed:83.55s
Val set: Epoch: 7, Average loss:2.2669, Top-1 Accuracy: 48.1600%, Top-5 Accuracy: 79.4800%, Time consumed:8.31s

New best top-1 accuracy: 48.16%, top-5 accuracy: 79.48%
New best top-5 accuracy: 79.48%
Validation loss decreased (2.673488 --> 2.266854). Saving model ...
Epoch [8], Batch [50/313], Loss: 1.6513
Epoch [8], Batch [100/313], Loss: 1.5053
Epoch [8], Batch [150/313], Loss: 3.6494
Epoch [8], Batch [200/313], Loss: 1.8956
Epoch [8], Batch [250/313], Loss: 2.3423
Epoch [8], Batch [300/313], Loss: 1.9236
Train set: Epoch: 8, Average loss:2.3246, LR: 0.001000 Top-1 Accuracy: 45.1275%, Top-5 Accuracy: 75.3700%, Time consumed:81.73s
Val set: Epoch: 8, Average loss:2.6984, Top-1 Accuracy: 43.6400%, Top-5 Accuracy: 76.7800%, Time consumed:9.00s

EarlyStopping 카운터: 1 / 10
Epoch [9], Batch [50/313], Loss: 1.3532
Epoch [9], Batch [100/313], Loss: 1.5046
Epoch [9], Batch [150/313], Loss: 1.5240
Epoch [9], Batch [200/313], Loss: 3.6225
Epoch [9], Batch [250/313], Loss: 3.4138
Epoch [9], Batch [300/313], Loss: 3.2752
Train set: Epoch: 9, Average loss:2.2583, LR: 0.001000 Top-1 Accuracy: 48.0225%, Top-5 Accuracy: 77.3800%, Time consumed:81.56s
Val set: Epoch: 9, Average loss:2.3896, Top-1 Accuracy: 51.7000%, Top-5 Accuracy: 81.5600%, Time consumed:8.85s

New best top-1 accuracy: 51.70%, top-5 accuracy: 81.56%
New best top-5 accuracy: 81.56%
EarlyStopping 카운터: 2 / 10
Epoch [10], Batch [50/313], Loss: 1.3117
Epoch [10], Batch [100/313], Loss: 1.5127
Epoch [10], Batch [150/313], Loss: 1.3267
Epoch [10], Batch [200/313], Loss: 1.7004
Epoch [10], Batch [250/313], Loss: 3.0246
Epoch [10], Batch [300/313], Loss: 1.5497
Train set: Epoch: 10, Average loss:2.0418, LR: 0.001000 Top-1 Accuracy: 52.6850%, Top-5 Accuracy: 81.2375%, Time consumed:79.38s
Val set: Epoch: 10, Average loss:2.3230, Top-1 Accuracy: 54.8400%, Top-5 Accuracy: 82.9200%, Time consumed:8.76s

New best top-1 accuracy: 54.84%, top-5 accuracy: 82.92%
New best top-5 accuracy: 82.92%
EarlyStopping 카운터: 3 / 10
Epoch [11], Batch [50/313], Loss: 1.4192
Epoch [11], Batch [100/313], Loss: 3.6538
Epoch [11], Batch [150/313], Loss: 3.0252
Epoch [11], Batch [200/313], Loss: 3.4628
Epoch [11], Batch [250/313], Loss: 1.4069
Epoch [11], Batch [300/313], Loss: 3.2864
Train set: Epoch: 11, Average loss:2.0300, LR: 0.001000 Top-1 Accuracy: 53.7325%, Top-5 Accuracy: 81.2800%, Time consumed:83.48s
Val set: Epoch: 11, Average loss:1.7560, Top-1 Accuracy: 53.1400%, Top-5 Accuracy: 83.0200%, Time consumed:9.86s

New best top-5 accuracy: 83.02%
Validation loss decreased (2.266854 --> 1.756017). Saving model ...
Epoch [12], Batch [50/313], Loss: 2.9855
Epoch [12], Batch [100/313], Loss: 1.0805
Epoch [12], Batch [150/313], Loss: 1.1718
Epoch [12], Batch [200/313], Loss: 1.6149
Epoch [12], Batch [250/313], Loss: 1.3021
Epoch [12], Batch [300/313], Loss: 2.4411
Train set: Epoch: 12, Average loss:1.8758, LR: 0.001000 Top-1 Accuracy: 57.3800%, Top-5 Accuracy: 83.5450%, Time consumed:81.29s
Val set: Epoch: 12, Average loss:1.5581, Top-1 Accuracy: 57.2200%, Top-5 Accuracy: 85.9600%, Time consumed:9.32s

New best top-1 accuracy: 57.22%, top-5 accuracy: 85.96%
New best top-5 accuracy: 85.96%
Validation loss decreased (1.756017 --> 1.558083). Saving model ...
Epoch [13], Batch [50/313], Loss: 2.3695
Epoch [13], Batch [100/313], Loss: 0.9344
Epoch [13], Batch [150/313], Loss: 1.0876
Epoch [13], Batch [200/313], Loss: 2.9033
Epoch [13], Batch [250/313], Loss: 0.9727
Epoch [13], Batch [300/313], Loss: 1.2209
Train set: Epoch: 13, Average loss:1.7977, LR: 0.001000 Top-1 Accuracy: 59.0425%, Top-5 Accuracy: 84.5525%, Time consumed:83.08s
Val set: Epoch: 13, Average loss:1.6493, Top-1 Accuracy: 57.0600%, Top-5 Accuracy: 85.1400%, Time consumed:8.52s

EarlyStopping 카운터: 1 / 10
Epoch [14], Batch [50/313], Loss: 3.0402
Epoch [14], Batch [100/313], Loss: 2.0803
Epoch [14], Batch [150/313], Loss: 1.5297
Epoch [14], Batch [200/313], Loss: 0.7293
Epoch [14], Batch [250/313], Loss: 2.9598
Epoch [14], Batch [300/313], Loss: 0.9774
Train set: Epoch: 14, Average loss:1.7306, LR: 0.001000 Top-1 Accuracy: 63.1475%, Top-5 Accuracy: 87.7075%, Time consumed:78.31s
Val set: Epoch: 14, Average loss:1.4431, Top-1 Accuracy: 60.2800%, Top-5 Accuracy: 87.3600%, Time consumed:9.08s

New best top-1 accuracy: 60.28%, top-5 accuracy: 87.36%
New best top-5 accuracy: 87.36%
Validation loss decreased (1.558083 --> 1.443097). Saving model ...
Epoch [15], Batch [50/313], Loss: 0.7277
Epoch [15], Batch [100/313], Loss: 3.1994
Epoch [15], Batch [150/313], Loss: 3.0909
Epoch [15], Batch [200/313], Loss: 2.8032
Epoch [15], Batch [250/313], Loss: 0.7641
Epoch [15], Batch [300/313], Loss: 0.8466
Train set: Epoch: 15, Average loss:1.7571, LR: 0.001000 Top-1 Accuracy: 62.4275%, Top-5 Accuracy: 86.9375%, Time consumed:78.71s
Val set: Epoch: 15, Average loss:1.4157, Top-1 Accuracy: 61.2200%, Top-5 Accuracy: 87.7800%, Time consumed:8.51s

New best top-1 accuracy: 61.22%, top-5 accuracy: 87.78%
New best top-5 accuracy: 87.78%
Validation loss decreased (1.443097 --> 1.415721). Saving model ...
Epoch [16], Batch [50/313], Loss: 2.6627
Epoch [16], Batch [100/313], Loss: 2.9572
Epoch [16], Batch [150/313], Loss: 2.8578
Epoch [16], Batch [200/313], Loss: 2.6315
Epoch [16], Batch [250/313], Loss: 0.7596
Epoch [16], Batch [300/313], Loss: 2.8270
Train set: Epoch: 16, Average loss:1.5652, LR: 0.001000 Top-1 Accuracy: 67.0150%, Top-5 Accuracy: 89.1350%, Time consumed:77.45s
Val set: Epoch: 16, Average loss:1.3880, Top-1 Accuracy: 61.2200%, Top-5 Accuracy: 88.4600%, Time consumed:8.77s

New best top-5 accuracy: 88.46%
Validation loss decreased (1.415721 --> 1.388024). Saving model ...
Epoch [17], Batch [50/313], Loss: 2.6770
Epoch [17], Batch [100/313], Loss: 2.5186
Epoch [17], Batch [150/313], Loss: 0.6497
Epoch [17], Batch [200/313], Loss: 2.9644
Epoch [17], Batch [250/313], Loss: 0.4711
Epoch [17], Batch [300/313], Loss: 2.0107
Train set: Epoch: 17, Average loss:1.5145, LR: 0.001000 Top-1 Accuracy: 68.7675%, Top-5 Accuracy: 89.8950%, Time consumed:77.49s
Val set: Epoch: 17, Average loss:1.4378, Top-1 Accuracy: 60.4200%, Top-5 Accuracy: 87.6800%, Time consumed:8.59s

EarlyStopping 카운터: 1 / 10
Epoch [18], Batch [50/313], Loss: 1.7579
Epoch [18], Batch [100/313], Loss: 2.4723
Epoch [18], Batch [150/313], Loss: 0.7226
Epoch [18], Batch [200/313], Loss: 3.1106
Epoch [18], Batch [250/313], Loss: 2.3181
Epoch [18], Batch [300/313], Loss: 0.6899
Train set: Epoch: 18, Average loss:1.5069, LR: 0.001000 Top-1 Accuracy: 70.0425%, Top-5 Accuracy: 90.3450%, Time consumed:77.68s
Val set: Epoch: 18, Average loss:1.4383, Top-1 Accuracy: 60.8000%, Top-5 Accuracy: 87.0600%, Time consumed:8.66s

EarlyStopping 카운터: 2 / 10
Epoch [19], Batch [50/313], Loss: 2.8707
Epoch [19], Batch [100/313], Loss: 0.4202
Epoch [19], Batch [150/313], Loss: 0.4152
Epoch [19], Batch [200/313], Loss: 0.5902
Epoch [19], Batch [250/313], Loss: 0.3313
Epoch [19], Batch [300/313], Loss: 2.7965
Train set: Epoch: 19, Average loss:1.3506, LR: 0.001000 Top-1 Accuracy: 72.4775%, Top-5 Accuracy: 90.6300%, Time consumed:79.46s
Val set: Epoch: 19, Average loss:1.3991, Top-1 Accuracy: 61.8600%, Top-5 Accuracy: 87.6400%, Time consumed:8.56s

New best top-1 accuracy: 61.86%, top-5 accuracy: 87.64%
EarlyStopping 카운터: 3 / 10
Epoch [20], Batch [50/313], Loss: 0.3532
Epoch [20], Batch [100/313], Loss: 2.2892
Epoch [20], Batch [150/313], Loss: 2.6096
Epoch [20], Batch [200/313], Loss: 0.4125
Epoch [20], Batch [250/313], Loss: 0.4420
Epoch [20], Batch [300/313], Loss: 3.0153
Train set: Epoch: 20, Average loss:1.3312, LR: 0.001000 Top-1 Accuracy: 75.3125%, Top-5 Accuracy: 92.3600%, Time consumed:78.29s
Val set: Epoch: 20, Average loss:1.4065, Top-1 Accuracy: 63.0600%, Top-5 Accuracy: 87.7800%, Time consumed:8.47s

New best top-1 accuracy: 63.06%, top-5 accuracy: 87.78%
EarlyStopping 카운터: 4 / 10
Epoch [21], Batch [50/313], Loss: 0.2979
Epoch [21], Batch [100/313], Loss: 0.3211
Epoch [21], Batch [150/313], Loss: 1.4220
Epoch [21], Batch [200/313], Loss: 1.0082
Epoch [21], Batch [250/313], Loss: 2.2436
Epoch [21], Batch [300/313], Loss: 2.2936
Train set: Epoch: 21, Average loss:1.2560, LR: 0.001000 Top-1 Accuracy: 76.4950%, Top-5 Accuracy: 92.8700%, Time consumed:80.69s
Val set: Epoch: 21, Average loss:1.5282, Top-1 Accuracy: 61.5800%, Top-5 Accuracy: 86.6800%, Time consumed:8.61s

EarlyStopping 카운터: 5 / 10
Epoch [22], Batch [50/313], Loss: 0.3305
Epoch [22], Batch [100/313], Loss: 1.9485
Epoch [22], Batch [150/313], Loss: 0.3277
Epoch [22], Batch [200/313], Loss: 0.2879
Epoch [22], Batch [250/313], Loss: 0.4624
Epoch [22], Batch [300/313], Loss: 0.2596
Train set: Epoch: 22, Average loss:1.2940, LR: 0.001000 Top-1 Accuracy: 76.4125%, Top-5 Accuracy: 92.8550%, Time consumed:79.16s
Val set: Epoch: 22, Average loss:1.3934, Top-1 Accuracy: 63.0600%, Top-5 Accuracy: 87.9200%, Time consumed:8.28s

EarlyStopping 카운터: 6 / 10
Epoch [23], Batch [50/313], Loss: 2.6959
Epoch [23], Batch [100/313], Loss: 0.2118
Epoch [23], Batch [150/313], Loss: 2.8110
Epoch [23], Batch [200/313], Loss: 2.2972
Epoch [23], Batch [250/313], Loss: 0.7375
Epoch [23], Batch [300/313], Loss: 2.5713
Train set: Epoch: 23, Average loss:1.3152, LR: 0.001000 Top-1 Accuracy: 76.8075%, Top-5 Accuracy: 92.7750%, Time consumed:77.10s
Val set: Epoch: 23, Average loss:1.6885, Top-1 Accuracy: 62.1600%, Top-5 Accuracy: 87.1400%, Time consumed:8.94s

EarlyStopping 카운터: 7 / 10
Epoch [24], Batch [50/313], Loss: 0.3064
Epoch [24], Batch [100/313], Loss: 0.2254
Epoch [24], Batch [150/313], Loss: 2.4513
Epoch [24], Batch [200/313], Loss: 0.3027
Epoch [24], Batch [250/313], Loss: 2.6531
Epoch [24], Batch [300/313], Loss: 2.0898
Train set: Epoch: 24, Average loss:1.1562, LR: 0.001000 Top-1 Accuracy: 78.5900%, Top-5 Accuracy: 93.1875%, Time consumed:77.43s
Val set: Epoch: 24, Average loss:1.4627, Top-1 Accuracy: 63.1800%, Top-5 Accuracy: 87.3600%, Time consumed:8.33s

New best top-1 accuracy: 63.18%, top-5 accuracy: 87.36%
EarlyStopping 카운터: 8 / 10
Epoch [25], Batch [50/313], Loss: 2.5090
Epoch [25], Batch [100/313], Loss: 0.1510
Epoch [25], Batch [150/313], Loss: 0.1405
Epoch [25], Batch [200/313], Loss: 0.1938
Epoch [25], Batch [250/313], Loss: 0.1619
Epoch [25], Batch [300/313], Loss: 2.6490
Train set: Epoch: 25, Average loss:1.0438, LR: 0.001000 Top-1 Accuracy: 82.3550%, Top-5 Accuracy: 94.8275%, Time consumed:78.57s
Val set: Epoch: 25, Average loss:1.4450, Top-1 Accuracy: 63.2600%, Top-5 Accuracy: 87.6800%, Time consumed:8.65s

New best top-1 accuracy: 63.26%, top-5 accuracy: 87.68%
EarlyStopping 카운터: 9 / 10
Epoch [26], Batch [50/313], Loss: 0.0924
Epoch [26], Batch [100/313], Loss: 0.1286
Epoch [26], Batch [150/313], Loss: 2.5432
Epoch [26], Batch [200/313], Loss: 1.9826
Epoch [26], Batch [250/313], Loss: 0.2725
Epoch [26], Batch [300/313], Loss: 0.3138
Train set: Epoch: 26, Average loss:1.1265, LR: 0.001000 Top-1 Accuracy: 81.6075%, Top-5 Accuracy: 94.4425%, Time consumed:77.54s
Val set: Epoch: 26, Average loss:1.5407, Top-1 Accuracy: 61.3600%, Top-5 Accuracy: 86.1800%, Time consumed:8.27s

EarlyStopping 카운터: 10 / 10
Early stopping triggered. Training stopped.
Loading best model from early stopping checkpoint...
Test set: Epoch: 100, Average loss:1.4863, Top-1 Accuracy: 61.6000%, Top-5 Accuracy: 85.7800%, Time consumed:10.06s

Finish! Best validation top-1 accuracy: 63.26%, Best validation top-5 accuracy: 88.46%
Final test top-1 accuracy: 61.60%, Final test top-5 accuracy: 85.78%
Total training time: 2319.96 seconds
